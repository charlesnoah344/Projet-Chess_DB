<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="1100" d:DesignHeight="800"
             Foreground="{DynamicResource PrimaryForeground}"
             Background="{DynamicResource PrimaryBackground}"
             xmlns:vm="clr-namespace:Chess_D_B.ViewModels"
             x:DataType="vm:AjouterMatchPageViewModel"
             x:Class="Chess_D_B.Views.AjouterMatchPageView">
    
    <Grid RowDefinitions="Auto, Auto, *, Auto">
        
        <!-- Header -->
        <Border Grid.Row="0" Background="#2980b9" Padding="20">
            <TextBlock Text="â™Ÿï¸ Ajouter un Match" 
                       FontSize="28" 
                       FontWeight="Bold"
                       Foreground="White"
                       HorizontalAlignment="Center"/>
        </Border>
        
        <!-- Message -->
        <Border Grid.Row="1" Padding="15" Background="#3498db">
            <TextBlock Text="{Binding Message}" 
                       FontSize="14"
                       FontWeight="Bold"
                       Foreground="White"
                       HorizontalAlignment="Center"/>
        </Border>
        
        <!-- Contenu -->
        <ScrollViewer Grid.Row="2">
            <Grid ColumnDefinitions="*, *" Margin="20" ColumnSpacing="20">
                
                <!-- Colonne gauche : Informations du match -->
                <StackPanel Grid.Column="0" Spacing="15">
                    
                    <Border BorderBrush="#2980b9" 
                            BorderThickness="2" 
                            CornerRadius="5"
                            Padding="20">
                        <StackPanel Spacing="15">
                            
                            <TextBlock Text="ðŸ“‹ Informations du match" 
                                       FontSize="18" 
                                       FontWeight="Bold"
                                       Foreground="#2980b9"/>
                            
                            <!-- SÃ©lection de la compÃ©tition -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="CompÃ©tition *" FontWeight="Bold" FontSize="14"/>
                                <ComboBox ItemsSource="{Binding Competitions}"
                                          SelectedItem="{Binding CompetitionSelectionnee}"
                                          Height="40"
                                          Background="#333B5A"
                                          HorizontalAlignment="Stretch"
                                          IsEnabled="{Binding !EstEnChargement}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock>
                                                <Run Text="{Binding Tournoi}" FontWeight="Bold"/>
                                                <Run Text=" - "/>
                                                <Run Text="{Binding DateDebut, StringFormat='dd/MM/yyyy'}"/>
                                            </TextBlock>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                            
                            <!-- Joueur Blanc -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="âšª Joueur Blanc *" FontWeight="Bold" FontSize="14"/>
                                <ComboBox ItemsSource="{Binding JoueursParticipants}"
                                          SelectedItem="{Binding JoueurBlancSelectionne}"
                                          Height="40"
                                          Background="#333B5A"
                                          HorizontalAlignment="Stretch"
                                          IsEnabled="{Binding !EstEnChargement}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock>
                                                <Run Text="{Binding Prenom}"/>
                                                <Run Text=" "/>
                                                <Run Text="{Binding Nom}"/>
                                                <Run Text=" (ELO: "/>
                                                <Run Text="{Binding Elo}"/>
                                                <Run Text=")"/>
                                            </TextBlock>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                            
                            <!-- Joueur Noir -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="âš« Joueur Noir *" FontWeight="Bold" FontSize="14"/>
                                <ComboBox ItemsSource="{Binding JoueursParticipants}"
                                          SelectedItem="{Binding JoueurNoirSelectionne}"
                                          Height="40"
                                          Background="#333B5A"
                                          HorizontalAlignment="Stretch"
                                          IsEnabled="{Binding !EstEnChargement}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock>
                                                <Run Text="{Binding Prenom}"/>
                                                <Run Text=" "/>
                                                <Run Text="{Binding Nom}"/>
                                                <Run Text=" (ELO: "/>
                                                <Run Text="{Binding Elo}"/>
                                                <Run Text=")"/>
                                            </TextBlock>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </StackPanel>
                            
                            <!-- Date et durÃ©e -->
                            <Grid ColumnDefinitions="1.5*, *" ColumnSpacing="10">
                                <StackPanel Grid.Column="0" Spacing="8">
                                    <TextBlock Text="Date du match *" FontWeight="Bold" FontSize="14"/>
                                    <DatePicker SelectedDate="{Binding DateMatch}" 
                                                Height="40" 
                                                Background="#333B5A"
                                                IsEnabled="{Binding !EstEnChargement}"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" Spacing="8">
                                    <TextBlock Text="DurÃ©e (min)" FontWeight="Bold" FontSize="14"/>
                                    <NumericUpDown Value="{Binding DureeMinutes}" 
                                                   Minimum="1" 
                                                   Maximum="300" 
                                                   Background="#333B5A" 
                                                   Height="40"
                                                   IsEnabled="{Binding !EstEnChargement}"/>
                                </StackPanel>
                            </Grid>
                            
                            <!-- RÃ©sultat -->
                            <StackPanel Spacing="8">
                                <TextBlock Text="RÃ©sultat *" FontWeight="Bold" FontSize="14"/>
                                <ComboBox ItemsSource="{Binding Resultats}"
                                          SelectedItem="{Binding ResultatSelectionne}"
                                          Height="40"
                                          Background="#333B5A"
                                          HorizontalAlignment="Stretch"
                                          IsEnabled="{Binding !EstEnChargement}"/>
                            </StackPanel>
                            
                        </StackPanel>
                    </Border>
                    
                    <!-- Notes -->
                    <Border BorderBrush="#2980b9" 
                            BorderThickness="2" 
                            CornerRadius="5"
                            Padding="20">
                        <StackPanel Spacing="10">
                            <TextBlock Text="ðŸ“ Notes / Commentaires" 
                                       FontSize="16" 
                                       FontWeight="Bold"
                                       Foreground="#2980b9"/>
                            
                            <TextBox Text="{Binding Notes}"
                                     AcceptsReturn="True"
                                     TextWrapping="Wrap"
                                     Height="150"
                                     Background="#333B5A"
                                     Watermark="Commentaires sur le match, conditions de jeu, incidents..."
                                     IsEnabled="{Binding !EstEnChargement}"/>
                        </StackPanel>
                    </Border>
                    
                </StackPanel>
                
                <!-- Colonne droite : Coups du match -->
                <Border Grid.Column="1" 
                        BorderBrush="#2980b9" 
                        BorderThickness="2" 
                        CornerRadius="5"
                        Padding="20">
                    <StackPanel Spacing="15">
                        
                        <TextBlock Text="â™Ÿï¸ Coups du match *" 
                                   FontSize="18" 
                                   FontWeight="Bold"
                                   Foreground="#2980b9"/>
                        
                        <TextBlock TextWrapping="Wrap" 
                                   FontSize="12" 
                                   Foreground="#95a5a6">
                            <Run Text="Entrez tous les coups de la partie."/>
                            <LineBreak/>
                            <Run Text="Format suggÃ©rÃ© : 1. e4 e5 2. Nf3 Nc6 3. Bb5 a6 ..."/>
                            <LineBreak/>
                            <Run Text="Vous pouvez aussi utiliser la notation PGN."/>
                        </TextBlock>
                        
                        <!-- ZONE DE TEXTE MULTI-LIGNES POUR TOUS LES COUPS -->
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                                <TextBox Text="{Binding Coups}"
                                 AcceptsReturn="True"
                                 TextWrapping="Wrap"
                                 Height="520"
                                 Background="#333B5A"
                                 FontFamily="Consolas"
                                 FontSize="13"
                                 Watermark="1. e4 e5&#x0a;2. Nf3 Nc6&#x0a;3. Bb5 a6&#x0a;4. Ba4 Nf6&#x0a;5. O-O Be7&#x0a;6. Re1 b5&#x0a;..."
                                 IsEnabled="{Binding !EstEnChargement}"/>
                        </ScrollViewer>
                        
                        <TextBlock Text="{Binding Coups.Length, StringFormat='ðŸ“Š {0} caractÃ¨res'}" 
                                   FontSize="11" 
                                   Foreground="#95a5a6"
                                   HorizontalAlignment="Right"/>
                        
                    </StackPanel>
                </Border>
                
            </Grid>
        </ScrollViewer>
        
        <!-- Footer -->
        <StackPanel Grid.Row="3" Margin="20" Spacing="10">
            
            <ProgressBar IsIndeterminate="True" 
                         IsVisible="{Binding EstEnChargement}"
                         Height="4"/>
            
            <Grid ColumnDefinitions="*, *" ColumnSpacing="10">
                <Button Grid.Column="0"
                        Content="â† Retour"
                        Command="{Binding RetourCommand}"
                        HorizontalAlignment="Stretch"
                        Height="45"
                        IsEnabled="{Binding !EstEnChargement}"/>
                
                <Button Grid.Column="1"
                        Content="âœ“ Enregistrer le match"
                        Command="{Binding EnregistrerCommand}"
                        HorizontalAlignment="Stretch"
                        Height="45"
                        Classes="menu"
                        IsEnabled="{Binding !EstEnChargement}"/>
            </Grid>
            
        </StackPanel>
        
    </Grid>
</UserControl>